

<template name="index">

<script src="https://apis.google.com/js/platform.js" async defer></script>
<script src="https://connect.facebook.net/en_US/all/debug.js" async defer></script>

<meta name="google-signin-client_id" content="335819699102-a8ukb4755trrurg154vrqgh5m1otpjp7.apps.googleusercontent.com">

   {{> header}}
   {{> index_content}}
</template>
<template name="index_content">
   <body class="body-bg-white" >
      <!-- Header-BP-logout -->
      <div class="stunning-header bg-primary-opacity">
         <header class="header header--logout" id="site-header">
            <div class="page-title wm_logo">
               <img src="img/logo_wm.png">
            </div>
            <div class="header-content-wrapper">
               <div class="form--login-logout">
                  <form class="form-inline">
                     <div class="form-group md-form label-floating" style="width: 200px;">
                        <label for="Email" class="control-label " data-success="right" data-error="wrong">Email</label>
                        <input id="login_email" required="required" class="form-control validate " placeholder="" type="text">
                     </div>
                     <div class="form-group md-form  label-floating is-empty with-button c-white" style="width: 200px;">
                        <label for="Email" class="control-label c-light-grey" data-success="right" data-error="wrong">Password</label>
                        <input id="login_password" class="form-control validate c-white" type="password" placeholder="">
                        <a href="#"><span class="trans_bg show_signup_password_2" > <i class="fa fa-eye"> </i> </span></a>
                     </div>
                     <br/>
                     <button class="btn btn-breez btn-md-2 " style="margin-bottom: 0px !important;" id="login_submit">Sign in</button>
                     <a href="javascript:void(0)" id="forgot_password" >
                     <label for="Email" class="control-label" data-success="right" data-error="wrong" style="font-size: 11px;">Forgot password?</label>
                     </a>
                  </form>
                  <button class="btn btn-mdb-color btn-md-2 login-btn-responsive btn-rounded float-right button" type="button" style="margin-bottom: 0px !important;"><span>Join Now </span></button>
               </div>
            </div>
         </header>
         <!-- ... end Header-BP-logout -->
         <!-- Top Header-Profile Logout -->
         <!-- ... end Top Header-Profile Logout -->
         <div class="header-spacer"></div>
         <div class="stunning-header-content">
            <div class="logout-content text-left">
               <div class="d-flex justify-content-left">
                  <!-- Grid row -->
                  <div class="row " style="padding:0 4%; ">
                     <!-- Grid column -->
                     <div class="col col-xl-7 col-lg-7 col-md-12 col-sm-12 col-12 pl-md-0 padd-10" >
                        <div class="landing-content c-grey my-4">
                           <!-- <br/>
                           <br/>
                           <br/>
                           <br/> -->
                           <h1 class="c-darkgray" style="font-size: 45px; margin-bottom: 15px; font-weight: 600;"><strong>Welcome to WritersMelon </strong></h1>
                           <h5 class="c-darkgray" style="font-size: 19px; font-weight: 400;     line-height: 29px;"> Discover great Books & Authors.  <br/>And Engage in ‘real’ conversation around  BOOKS , AUTHORS & WRITING. </h5>
                        </div>
                     </div>
                     <!-- Grid column -->
                     <!-- Grid column -->
                     <div class="col-12 hidden-sm hidden-md hidden-lg" style="background-color: rgba(203, 18, 48, 1);   padding: 5%; border: 1px solid #cb1230;     border-radius: 10px; margin-bottom: 20px">
                       <div class="header-content-wrapper">
                         <div class="" style="width:100%">
                            <form class=" ">
                               <div class="form-group md-form label-floating" >
                                  <label for="Email" class="control-label " data-success="right" data-error="wrong">Email</label>
                                  <input id="login_email" required="required" class="form-control validate " placeholder="" type="text">
                               </div>
                               <div class="form-group md-form  label-floating is-empty with-button c-white" >
                                  <label for="Email" class="control-label c-light-grey" data-success="right" data-error="wrong">Password</label>
                                  <input id="login_password" class="form-control validate c-white" type="password" placeholder="">
                                  <a href="#"><span class="trans_bg show_signup_password_2" > <i class="fa fa-eye"> </i> </span></a>
                               </div>
                               <br/>
                               <a href="javascript:void(0)" id="forgot_password" >
                               <label for="Email" class="control-label" data-success="right" data-error="wrong" style="font-size: 11px;">Forgot password?</label>
                               </a>
                               <button class="btn btn-breez btn-md-2 " style="margin-bottom: 0px !important;" id="login_submit">Sign in</button>
                               
                            </form>
                            <!-- <button class="btn btn-mdb-color btn-md-2 login-btn-responsive btn-rounded float-right button" type="button" style="margin-bottom: 0px !important;"><span>Join Now </span></button> -->
                         </div>
                       </div>
                     </div>

                     <div class="col col-xl-5 col-lg-5 col-md-12 col-sm-12 col-12 pl-md-0">
                        <form role="form" action="" method="post">
                           <!-- First Step -->
                           <div class="row setup-content-3" id="step-5" style="background-color: rgba(203, 18, 48, 1);   padding: 5%; border: 1px solid #cb1230;     border-radius: 10px;">
                              <div class="col-md-12">
                                 <h3 class="font-weight-bold pl-0 c-white" style="margin-bottom: 20px !important;"><strong>Join now</strong></h3>
                                 <div class="form-group md-form  label-floating">
                                    <label for="Name" class="control-label c-light-grey" data-success="right" data-error="wrong">Full Name </label>
                                    <input id="signup_name" required="required" class="form-control validate c-white" placeholder="" type="text" maxlength="40" autocomplete="off" >
                                 </div>
                                 <div class="form-group md-form label-floating">
                                    <!-- <div class="form-group md-form label-floating has-success" id="show_response" > -->
                                    <label for="Email" class="control-label c-light-grey" data-success="right">Email</label>
                                    <!--                                         <input id="signup_email" required="required" class="form-control validate c-white" placeholder="" type="text" > -->
                                    <input id="signup_email" required="required" class="form-control validate c-white" placeholder="" type="text"  onfocusout="ValidateEmail(event)" autocomplete="off" >
                                 </div>
                                 <div class="form-group md-form  label-floating is-empty with-button c-white" >
                                    <label for="Email" class="control-label c-light-grey" data-success="right" data-error="wrong">Password (atleast 8 chars.)</label>
                                    <input class="form-control validate c-white" type="password" id="signup_password" autocomplete="off" >
                                    <a href="#"><span class="trans_bg show_signup_password"> <i class="fa fa-eye"> </i> </span></a>
                                 </div>
                                 <div class="form-group md-form label-floating is-empty c-white">
                                    By clicking <a>Sign up </a>, you agree to<b> WritersMelon's </b><a href="#" class="c-white"><u>User Agreement</u></a>, <a href="#" class="c-white"><u>Privacy </u></a> and <a href="#" class="c-white"><u>Cookie Policies </u></a>.
                                 </div>
                                 <span>

                                 <button class="btn btn-mdb-color btn-rounded float-right button" type="button" id="submit_signup" style="display: none !important" ><span> Sign up </span></button>
                                 </span>

                              </div>
                              <div class="col-lg-12 col-md-12 col-sm-12 text-center">
                                 <p class="c-white" style="font-size: 20px;">or Sign in with</p>
                              </div>
                              <div class="col-lg-6 col-md-12 col-sm-12 text-center">
                                 <a href="#" class="btn btn-md btn-border c-white" style="width: 100%;">
                                 <img src="img/facebook.png" style="width: 16px;"> </a>
                              </div>
                              <div class="col-lg-6 col-md-12 col-sm-12 text-center">
                                 <a href="javascript:void(0)" class="btn btn-md btn-border c-white" style="width: 100%;" id="clicked_on_gmail" >
                                 <img src="img/google-plus.png" style="width: 16px;"> </a>


                              </div>


                           </div>
                        </form>

         <!-- <button class="g-signin2" id="google_login" data-onsuccess="onSignIn" onclick="click_google_login()" ></button>   -->
            <a class="btn fb_bt btn-home format_join join_btn_signup height_sub login-btn mouse_ani" data-toggle="tooltip" data-placement="top" title="Facebook" id="login_with_facebook" onclick="login()" >
              <i class="fa fa-facebook login_social_icon"></i>
              <span class="hidden-xs"></span>
            </a>
         <div class="g-signin2" data-onsuccess="onSignIn" onclick="click_google_login()"  id="google_login" ></div>
  

                     </div>
                     <!-- Grid column -->
                  </div>
                  <!-- Grid row -->
               </div>
            </div>
         </div>
         <div class="content-bg-wrap stunning-header-bg1"></div>
      </div>
      <section class="pt20">
         <div class="container">
            <div class="row">
               <div class="col col-xl-8 col-lg-8 col-md-12 col-sm-12 col-12">
                  <div class="ui-block responsive-flex1200 bg_trans">
                     <div class="row ui-block-title pad_0">
                        <h1 class="col-lg-8 col-md-8 col-xs-6" style="font-size: 30px; font-weight: 600; float: left;">Book</h1>
                     </div>
                  </div>
               </div>
            </div>
            <hr class="new4">
            <div class="row">
               {{#each show_book_details}} 
               <div class="col col-xl-3 col-lg-3 col-md-6 col-sm-12 col-12 redirect_to_login">
                  <article class="hentry blog-post ui-block" >
                     <div class="post-thumb" style="height: 200px;"><img src="{{book_cover}}" alt="photo" style="height: 100%;" >                   
                     </div>
                     <div class="post-content padd_10_both"><a href="#" class="h5 post-title margin_btm">{{book_name_with_trim}}</a>
                     </div>
                  </article>
               </div>
               {{else}}
               <p> No blogs to display.</p>
               {{/each}}
            </div>
            <div class="row">
               <div class="col col-xl-8 col-lg-8 col-md-12 col-sm-12 col-12">
                  <div class="ui-block responsive-flex1200 bg_trans">
                     <div class="ui-block-title pad_0">
                        <h1 style="font-size: 30px; font-weight: 500;">Blog</h1>
                     </div>
                  </div>
               </div>
            </div>
            <hr class="new4">
            <div class="row">
               {{#each show_blog_details}}        
               <div class="col col-xl-3 col-lg-3 col-md-6 col-sm-12 col-12 redirect_to_login">
                  <article class="hentry blog-post ui-block">
                     <div class="post-thumb">
                        <img height="200" src="{{blog_cover}}" alt="photo">
                        <div class="bottom-right"><a href="#" class="post-add-icon inline-items"><img src="img/comment_white.png"><span>56</span></a></div>
                        <div class="bottom-left"><a href="#" class="post-add-icon inline-items"><img src="img/heart_white.png"><span>27</span></a></div>
                     </div>
                     <div class="post-content">
                        <a href="#" class="h5 post-title">{{blog_title}}</a>
                        {{#each fetch_user_info}}
                        <div class="post__author author vcard inline-items">
                           <img src="{{user_profile_pic}}" alt="author">
                           <div class="author-date">
                              <a class="h5 post__author-name fn" href="02-ProfilePage.html">{{user_name}}</a><br/>
                              <div class="post__date">
                                 <time class="published" datetime="2017-03-24T18:18">{{user_headline}}</time>
                              </div>
                           </div>
                        </div>
                        {{/each}}      
                     </div>
                  </article>
               </div>
               {{else}}
               <p> No blogs to display.</p>
               {{/each}}
            </div>
            <div class="swiper-container pagination-bottom" data-slide="fade">
               <div class="swiper-wrapper">
                  <div class="swiper-slide swiper-slide-weather" data-swiper-parallax="-500">
                     <div class="day-wethear-item" data-mh="wethear-item">
                        <div class="col col-lg-8 m-auto col-md-8 col-sm-12 col-12">
                           <div class="main-header-content">
                              <h1 class="c-darkgray" style="font-size: 30px; font-weight: 500;">Testimonial</h1>
                              <h1 class="c-darkgray"></h1>
                              <p class="c-darkgray">The campaign was well planned and managed professionally. I was able to present my novel to book lovers through a detailed author interview. Insightful reviews of my novel gave the book a significant amount of online visibility. The live chat session on Twitter was extremely engaging. On the whole, it was an excellent book marketing campaign. My best wishes to Team Writersmelon. </p>
                              <br/> <br/>
                              <p class="c-darkgray">"DICRUZA VILSIYA"</p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <!-- If we need pagination -->
                  <div class="swiper-pagination pagination-blue"></div>
               </div>
            </div>
            <div class="related-products pt60 ">
               <div class="row">
                  <div class="col col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                     <div class="crumina-module crumina-heading with-title-decoration">
                        <h1 class="c-darkgray align-center" style="font-size: 30px; font-weight: 500;">We work with</h1>
                     </div>
                  </div>
                  <div class="col col-xl-2 col-lg-2 col-md-6 col-sm-12 col-12">
                     <!-- Product Item -->
                     <div class="shop-product-item">
                        <div class="product-thumb">
                           <img src="http://www.writersmelon.com/wm/wp-content/uploads/2017/06/aleph-100x100.jpg" alt="product">
                        </div>
                     </div>
                     <!-- ... end Product Item -->
                  </div>
                  <div class="col col-xl-2 col-lg-2 col-md-6 col-sm-12 col-12">
                     <!-- Product Item -->
                     <div class="shop-product-item">
                        <div class="product-thumb">
                           <img src="http://www.writersmelon.com/wm/wp-content/uploads/2017/06/HV-100x100.png" alt="product">
                        </div>
                     </div>
                     <!-- ... end Product Item -->
                  </div>
                  <div class="col col-xl-2 col-lg-2 col-md-6 col-sm-12 col-12">
                     <!-- Product Item -->
                     <div class="shop-product-item">
                        <div class="product-thumb">
                           <img src="http://www.writersmelon.com/wm/wp-content/uploads/2017/06/HV-100x100.png" alt="product">
                        </div>
                     </div>
                     <!-- ... end Product Item -->
                  </div>
                  <div class="col col-xl-2 col-lg-2 col-md-6 col-sm-12 col-12">
                     <!-- Product Item -->
                     <div class="shop-product-item">
                        <div class="product-thumb">
                           <img src="http://www.writersmelon.com/wm/wp-content/uploads/2017/06/aleph-100x100.jpg" alt="product">
                        </div>
                     </div>
                     <!-- ... end Product Item -->
                  </div>
                  <div class="col col-xl-2 col-lg-2 col-md-6 col-sm-12 col-12">
                     <!-- Product Item -->
                     <div class="shop-product-item">
                        <div class="product-thumb">
                           <img src="http://www.writersmelon.com/wm/wp-content/uploads/2017/06/aleph-100x100.jpg" alt="product">
                        </div>
                     </div>
                     <!-- ... end Product Item -->
                  </div>
                  <div class="col col-xl-2 col-lg-2 col-md-6 col-sm-12 col-12">
                     <!-- Product Item -->
                     <div class="shop-product-item">
                        <div class="product-thumb">
                           <img src="http://www.writersmelon.com/wm/wp-content/uploads/2017/06/aleph-100x100.jpg" alt="product">
                        </div>
                     </div>
                     <!-- ... end Product Item -->
                  </div>
               </div>
            </div>
         </div>
         <div class="sub-footer-copyright">
            <div class="container">
               <div class="row  ">
                  <span class="col-md-12 col-lg-3 col-sm-12">@2018 Copyright </span>
                  <span class="col-md-12 col-lg-6 col-sm-12"> <a href="#" class="c-white"> Preview Policy </a> &nbsp; &nbsp; | &nbsp; &nbsp;<a href="#"  class="c-white">Privacy Policy </a> &nbsp; &nbsp;| &nbsp; &nbsp; <a href="#"  class="c-white">Copyright Policy </a>  &nbsp; &nbsp;| &nbsp; &nbsp;  <a href="#"  class="c-white"> Testimonial </a>  </span>
                  <span class="col-md-12 col-lg-3 col-sm-12 align-right"> Powered by <a href="index.html">BITOVN</a> The neural network  </span>
               </div>
            </div>
         </div>
      </section>

   </body>
   <script type="text/javascript">
      function ValidateEmail(mail) {
      
        var email = $('#signup_email').val();
      
        if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(email)) {
        //   $('#show_response').addClass('label-floating has-success');
        // $('#show_response').removeClass('label-floating is-empty has-error');
          return (true);
        }
      
        swal({
          text: 'Please enter a valid email ID',
          button: "ok",
          icon: "warning",
          dangerMode: true,
        });
      
        // $('#show_response').addClass('label-floating is-empty has-error');
        //   $('#show_response').removeClass('label-floating has-success');
        return (false)
      }
      
   </script>

<script type="text/javascript">

    function click_google_login(){
      // alert("inside");
      Session.set("check_for_login",true);
   }

   function onSignIn(googleUser) {
   // alert("case 1");
   if(Session.get("check_for_login") == true){
   // if(check_for_login == true){
   // alert("case 2");

  var profile = googleUser.getBasicProfile();
  console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
  console.log('Name: ' + profile.getName());
  console.log('Image URL: ' + profile.getImageUrl());
  console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.

var getEmail = profile.getEmail();
var getName = profile.getName();
var getImageUrl = profile.getImageUrl();

var source = "Google";

        Meteor.call('check_for_google_login',getEmail,getName,getImageUrl,source,function(error,result){
              if(error){
                alert("Some error occure.");
              
              }else{

                  console.log('successfull login');
                  console.log(result);
                  var url = result.send_url;

                  if(url == '/feed'){
                      var userID = result.userID;
                      Session.setPersistent("userId",userID);
                      Router.go(url);
                  }
                  else{
                var userID = result.userID;
                Session.setPersistent("userId",userID);
                Router.go(url);

                  }


                }
          });
 }
}
</script>

<div id="fb-root"></div>

<script>
window.fbAsyncInit = function () {

      FB.init({
      appId      : '333621360803966',                        // App ID from the app dashboard
      status     : true,                                 // Check Facebook Login status
      xfbml      : true                                  // Look for social plugins on the page
    });
    }

    FB.AppEvents.logPageView(); 


  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));

  function login(){
        FB.login(function(response){
            if(response.status === 'connected'){
              testAPI();//getInfo();
              // alert('we are connected');
            } else if(response.status === 'not_authorized') {
                 show_alert("Not authorized");
            } else {
                show_alert("you are not logged in to Facebook");
            }

        },{scope: 'email'});
    }

    function testAPI() {
    console.log('Welcome!  Fetching your information.... ');
   
    FB.api('/me','GET', {fields: 'first_name,last_name,email,name,id'}, function(response) {
      console.log('Successful login for: ' + response.name);
      console.log(response);
      if(response.email == "" || response.email == undefined){
          show_alert("Your privacy for Email is not public");
          return false;
      }
      // show_loading_alert("Loading, please wait");

var getEmail = response.email;
var getName = response.name;
var getImageUrl = "http://graph.facebook.com/"+response.id+"/picture?type=large";

// alert(' getEmail: '+getEmail+' getName: '+getName+' getImageUrl: '+getImageUrl);
var source = "Facebook";

      Meteor.call("check_for_facebook_login",getEmail,getName,getImageUrl,source, function(error,result){
        if(error){
          show_alert("Something went wrong while fetching details")
        }else{
                  console.log('successfull login');
                  // alert('successfull login');
                  console.log(result);
                  var url = result.send_url;

                  if(url == '/feed'){
                      var userID = result.userID;
                      Session.setPersistent("userId",userID);
                      Router.go(url);
                  }
                  else{
                var userID = result.userID;
                Session.setPersistent("userId",userID);
                Router.go(url);

                  }
      }
      });
    });
  }



</script>
</template>

